# Protect A Windows 10 Machine Against Software Exploits By Deploying A GPO That Enforces Exploit Guard
Windows Defender Exploit Guard is a set of intrusion prevention capabilities designed to lock down a device against a wide variety of attack vectors and block behaviors commonly used in malware attacks. This, in turn enables enterprises to balance their security risk and productivity requirements more effectively.
The four components of Windows Defender Exploit Guard are:
- Attack Surface Reduction (ASR)
- Network Protection
- Controlled folder access
- Exploit Protection



## References
- [Enable exploit protection](https://learn.microsoft.com/en-us/defender-endpoint/enable-exploit-protection) by Microsoft
- [Create and deploy an Exploit Guard policy](https://learn.microsoft.com/en-us/mem/configmgr/protect/deploy-use/create-deploy-exploit-guard-policy) by Microsoft


## Tasks
- Generate an XML file with the settings from the machine by running the 'Get-ProcessMitigation' PowerShell cmdlet or using the Export button at the bottom of the Exploit Protection area in Windows Security
- Deploy the Group Policy on the machine to enable Windows Defender Exploit Guard


## Benchmarks
- Ensure that Exploit Guard is running on the machine



## Practical Approach
1. In a Windows 10 Pro VM, open PowerShell as admin, and run the following commmand to export the Exploit Protection settings to an XML file
   ```
   Get-ProcessMitigation -System | Out-File -FilePath "C:\ExploitProtectionConfig.xml"
   ```
2. An optional method is to use Windows Security GUI. Open Windows Security and navigate to `App & browser control > Exploit protection settings > Export settings` and save the configuration as an XML file
3. To use the Group Policy to enable Exploit Guard, press `Win + R` and enter `gpedit.msc`
4. If Windows Defender Exploit Guard is not in the Local Group Policy Editor, download and install it first from [this link](https://www.microsoft.com/en-us/download/details.aspx?id=104677) <br/>
   ![image](https://github.com/user-attachments/assets/c7ce841f-4475-451a-9ed4-23a20f66f7e6)

5. Navigate to `Computer Configuration > Administrative Templates > Windows Components > Windows Defender Exploit Guard > Exploit Protection` and double-click `Use a common set of exploit protection settings`
6. Enable the policy and specify the path to the XML file generated earlier. Check Enabled and under Options, enter the path to the XML file. <br/>
   ![image](https://github.com/user-attachments/assets/8749e9df-6165-4add-b3a4-808d0fb52330)
   Then click Apply and OK and update the Group Policy using cmd with admin privileges
   ```
   gpupdate /force
   ```
7. To verify that Exploit Guard is running, go to Windows Security GUI, and navigate to `App & browser control > Exploit protection settings`
8. Confirm that Exploit Protection settings (e.g., Attack Surface Reduction, Network Protection, Controlled Folder Access) are enabled
   ![image](https://github.com/user-attachments/assets/78f4ace5-6f4d-4ee7-9a92-43959cb95534)






















