# Protect A Windows 10 Machine Against Software Exploits By Deploying A GPO That Enforces Exploit Guard
Windows Defender Exploit Guard is a set of intrusion prevention capabilities designed to lock down a device against a wide variety of attack vectors and block behaviors commonly used in malware attacks. This, in turn enables enterprises to balance their security risk and productivity requirements more effectively.
The four components of Windows Defender Exploit Guard are:
- Attack Surface Reduction (ASR)
- Network Protection
- Controlled folder access
- Exploit Protection



## References
- [Enable exploit protection](https://learn.microsoft.com/en-us/defender-endpoint/enable-exploit-protection) by Microsoft
- [Create and deploy an Exploit Guard policy](https://learn.microsoft.com/en-us/mem/configmgr/protect/deploy-use/create-deploy-exploit-guard-policy) by Microsoft
- [Attack surface reduction rules reference](https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction-rules-reference) by Microsoft


## Tasks
- Generate an XML file with the settings from the machine by running the 'Get-ProcessMitigation' PowerShell cmdlet or using the Export button at the bottom of the Exploit Protection area in Windows Security
- Deploy the Group Policy on the machine to enable Windows Defender Exploit Guard


## Benchmarks
- Ensure that Exploit Guard is running on the machine



## Practical Approach
1. In a Windows 10 Pro VM, open PowerShell as admin, and run the following commmand to export the Exploit Protection settings to an XML file
   ```
   Get-ProcessMitigation -System | Out-File -FilePath "C:\ExploitProtectionConfig.xml"
   ```
2. An optional method is to use Windows Security GUI. Open Windows Security and navigate to `App & browser control > Exploit protection settings > Export settings` and save the configuration as an XML file
3. To use the Group Policy to enable Exploit Guard, press `Win + R` and enter `gpedit.msc`
4. If Windows Defender Exploit Guard is not in the Local Group Policy Editor, download and install it first from [this link](https://www.microsoft.com/en-us/download/details.aspx?id=104677) <br/>
   ![image](https://github.com/user-attachments/assets/c7ce841f-4475-451a-9ed4-23a20f66f7e6)

5. Navigate to `Computer Configuration > Administrative Templates > Windows Components > Windows Defender Exploit Guard > Exploit Protection` and double-click `Use a common set of exploit protection settings`
6. Enable the policy and specify the path to the XML file generated earlier. Check Enabled and under Options, enter the path to the XML file. <br/>
   ![image](https://github.com/user-attachments/assets/8749e9df-6165-4add-b3a4-808d0fb52330)
7. Attack Surface Reduction, Network Protection and Controlled Folder Access are also located in the Local Group Policy Editor. They can be found by navigating to `Computer Configuration > Administrative Templates > Windows Components > Microsoft Defender Antivirus > Microsoft Defender Exploit Guard`
8. To configure the Attack Surface Reduction rules, open the setting "Configure Attack Surface Reduction rules". Enable it and define the rules to be enabled. Use their GUIDs as listed in the [ASR Rules Documentation](https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction-rules-reference). An example is to enable "Block credential stealing from LSASS" by entering the following `{"D4F940AB-401B-4EFC-AADC-AD5F3C50688A": "Enabled"}` <br/>
   ![image](https://github.com/user-attachments/assets/c3db9c3a-f68d-4fd9-b318-29139a88d5e6)

9. To configure Controlled Folder Access, open the setting "Configure Controlled Folder Access" and enable it. Under Options, choose either Block: Only allow trusted apps to access protected folders or Audit: Logs any unauthorized access attempts but does not block them <br/>
   ![image](https://github.com/user-attachments/assets/bf0cc02f-5495-4de5-975a-46cee78163f3)

10. To configure Network Protection, open the setting "Prevent users and apps from accessing dangerous websites" and enable it <br/>
    ![image](https://github.com/user-attachments/assets/cd9c9493-0bf8-4f21-b7e6-d02e7e2adbef)

   
11. Then click Apply and OK and update the Group Policy using cmd with admin privileges
   ```
   gpupdate /force
   ```























